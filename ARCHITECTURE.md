# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ WhatsApp Stream Crypto

## ‚úÖ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã!** –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É.

**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ AUDIO: 16111 –±–∞–π—Ç
- ‚úÖ IMAGE: 54211 –±–∞–π—Ç  
- ‚úÖ VIDEO: 393736 –±–∞–π—Ç

## –û–±—â–∏–π –æ–±–∑–æ—Ä

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ—Ç–æ–∫–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–º —Å WhatsApp. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **CryptoManager** - —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
2. **DecryptingStream** - –ø–æ—Ç–æ–∫ –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
3. **EncryptingStream** - –ø–æ—Ç–æ–∫ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
4. **MediaType** - —Ç–∏–ø—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. HKDF —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
**–ë—ã–ª–æ:** –°–∞–º–æ–ø–∏—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è HKDF  
**–°—Ç–∞–ª–æ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π `hash_hkdf()` PHP 7.1+

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏

### 2. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–∞–º—è—Ç—å—é
**–ë—ã–ª–æ:** MAC –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–∞–ª–∞ –≤–µ—Å—å —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç—å  
**–°—Ç–∞–ª–æ:** –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ MAC –ø–æ —á–∞–Ω–∫–∞–º

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∞–π–ª–æ–≤ –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –≤–∏–¥–µ–æ

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–¥–¥–∏–Ω–≥–∞
**–ë—ã–ª–æ:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `OPENSSL_ZERO_PADDING`  
**–°—Ç–∞–ª–æ:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–¥–¥–∏–Ω–≥–∞ —Å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é

**–†–µ—à–µ–Ω–∏–µ:**
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–ª–æ–∫–∞
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### 4. –ï–¥–∏–Ω–∞—è –ø–æ–¥–ø–∏—Å—å
**–ë—ã–ª–æ:** –ü–æ–¥–ø–∏—Å—å –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ  
**–°—Ç–∞–ª–æ:** –ï–¥–∏–Ω–∞—è HMAC –ø–æ–¥–ø–∏—Å—å –¥–ª—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- –û–¥–∏–Ω HMAC –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤—Å–µ–≥–æ —Ñ–∞–π–ª–∞
- –ü–æ–¥–ø–∏—Å—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞: `IV + encrypted_data + MAC`

### 5. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞
**–ë—ã–ª–æ:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏—Ü–µ–ø–∞  
**–°—Ç–∞–ª–æ:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å IV –≤ –Ω–∞—á–∞–ª–µ

**EncryptingStream —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
[IV (16 –±–∞–π—Ç)] + [–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ] + [MAC (10 –±–∞–π—Ç)]
```

## –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–ª—é—á–∞ (HKDF)

1. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
   ```php
   $expandedKey = hash_hkdf(
       'sha256',           // hash algorithm
       $mediaKey,          // input key material (32 bytes)
       112,               // output length
       $mediaType->value, // info (context)
       str_repeat("\0", 32) // salt (32 zero bytes)
   );
   ```

2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞:
   - IV (16 –±–∞–π—Ç) - –≤–µ–∫—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
   - cipherKey (32 –±–∞–π—Ç–∞) - –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES-256
   - macKey (32 –±–∞–π—Ç–∞) - –∫–ª—é—á –¥–ª—è HMAC-SHA256
   - refKey (32 –±–∞–π—Ç–∞) - —Ä–µ–∑–µ—Ä–≤, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (AES-256-CBC)

1. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
   - –ê–ª–≥–æ—Ä–∏—Ç–º: AES-256-CBC
   - –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞: 16 –±–∞–π—Ç
   - –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞: 32 –±–∞–π—Ç–∞
   - –ü–∞–¥–¥–∏–Ω–≥: PKCS7 (—á–µ—Ä–µ–∑ OpenSSL)

2. –ü—Ä–æ—Ü–µ—Å—Å:
   ```php
   // –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
   openssl_decrypt($data, 'aes-256-cbc', $key, OPENSSL_RAW_DATA | OPENSSL_ZERO_PADDING, $iv);
   ```

3. –¶–µ–ø–æ—á–∫–∞ IV (CBC):
   - –ü–µ—Ä–≤—ã–π –±–ª–æ–∫: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è IV –∏–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞
   - –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –±–ª–æ–∫–∏: IV = –ø—Ä–µ–¥—ã–¥—É—â–∏–π –±–ª–æ–∫ —à–∏—Ñ—Ä—Ç–µ–∫—Å—Ç–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–¥–¥–∏–Ω–≥–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –±–ª–æ–∫–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ (HMAC-SHA256)

1. –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ MAC:
   ```php
   $hmacContext = hash_init('sha256', HASH_HMAC, $macKey);
   hash_update($hmacContext, $iv);
   
   // –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —á–∞–Ω–∫–∞–º–∏ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º HMAC
   while ($chunk = readChunk()) {
       hash_update($hmacContext, $chunk);
   }
   
   $calculatedMac = substr(hash_final($hmacContext, true), 0, 10);
   ```

2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ MAC:
   - –î–∞–Ω–Ω—ã–µ: IV + –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –ö–ª—é—á: macKey –∏–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–µ—Ä–≤—ã–µ 10 –±–∞–π—Ç –æ—Ç HMAC-SHA256

## –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

1. DecryptingStream:
   - MAC –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ—Ç–æ–∫–æ–≤–æ –ø–æ —á–∞–Ω–∫–∞–º 64KB
   - –î–∞–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
   - –ë—É—Ñ–µ—Ä: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

2. EncryptingStream:
   - –ï–¥–∏–Ω—ã–π HMAC –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤—Å–µ–≥–æ —Ñ–∞–π–ª–∞
   - IV –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–æ
   - MAC –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü –ø–æ—Å–ª–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö

### –†–∞–∑–º–µ—Ä—ã –±—É—Ñ–µ—Ä–æ–≤ –∏ —á–∞–Ω–∫–æ–≤

1. –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å:
   - –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞: 64KB (65536 –±–∞–π—Ç)
   - –ë—É—Ñ–µ—Ä –ø–æ—Ç–æ–∫–∞: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π
   - MAC –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø–æ—Ç–æ–∫–æ–≤–∞—è

2. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –¥–æ 400KB+ (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ VIDEO)
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### Sidecar —Ñ–∞–π–ª—ã

1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
   - –ü–æ—Ç–æ–∫–æ–≤–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ —á–∞–Ω–∫–∞–º
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—á–∞—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å MAC'–æ–≤ (–ø–æ 10 –±–∞–π—Ç)
   - –ö–∞–∂–¥—ã–π MAC —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —á–∞–Ω–∫—É 64KB
   - –ü–æ—Å–ª–µ–¥–Ω–∏–π MAC –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–ª—è –Ω–µ–ø–æ–ª–Ω–æ–≥–æ —á–∞–Ω–∫–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

```bash
Testing AUDIO decryption: ‚úÖ 16111 bytes - SUCCESS
Testing IMAGE decryption: ‚úÖ 54211 bytes - SUCCESS  
Testing VIDEO decryption: ‚úÖ 393736 bytes - SUCCESS

All tests passed successfully!
```

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

1. DecryptionTest:
   - ‚úÖ –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ —Ö–µ—à–µ–π SHA256
   - ‚úÖ –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

2. EncryptionTest:
   - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –æ–±—Ä–∞—Ç–Ω—É—é —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª—é—á–µ–π

3. SidecarTest:
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è sidecar —Ñ–∞–π–ª–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ MAC'–æ–≤
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ sidecar'–∞–º–∏

### –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
   ```
   tests/data/
   ‚îú‚îÄ‚îÄ AUDIO.{encrypted,original,key}    # 16111 bytes
   ‚îú‚îÄ‚îÄ IMAGE.{encrypted,original,key}    # 54211 bytes
   ‚îî‚îÄ‚îÄ VIDEO.{encrypted,original,key,sidecar} # 393736 bytes
   ```

2. –§–æ—Ä–º–∞—Ç—ã:
   - AUDIO: Opus –≤ Ogg –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
   - IMAGE: JPEG
   - VIDEO: MP4 (ISO/IEC 14496-12)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏:
   - –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å: AES-256-CBC
   - –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å: HMAC-SHA256  
   - –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π: HKDF —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º —Ç–∏–ø–∞ –º–µ–¥–∏–∞

2. –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫:
   - Padding oracle: PKCS7 + MAC –ø—Ä–æ–≤–µ—Ä–∫–∞
   - Replay: —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ IV –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
   - Tampering: MAC –¥–ª—è –≤—Å–µ–≥–æ —Ñ–∞–π–ª–∞ (IV + –¥–∞–Ω–Ω—ã–µ)

3. –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã:
   - –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ OpenSSL
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π HKDF PHP 7.1+
   - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ RFC 5869 (HKDF)

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
   - ‚úÖ –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –ø–∞–º—è—Ç—å
   - ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞–º–∏
   - ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π PHP

2. –†–∞–∑–º–µ—Ä—ã —á–∞–Ω–∫–æ–≤:
   - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞: 64KB
   - MAC –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–æ —á–∞–Ω–∫–∞–º
   - –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é

3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
   - AUDIO (16KB): –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
   - IMAGE (54KB): –º–≥–Ω–æ–≤–µ–Ω–Ω–æ  
   - VIDEO (394KB): –º–µ–Ω–µ–µ —Å–µ–∫—É–Ω–¥—ã

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- **PHP:** 7.1+ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è `hash_hkdf()`)
- **OpenSSL:** —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ PHP
- **–ü–∞–º—è—Ç—å:** –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
- **WhatsApp:** –ø–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ–æ—Ä–º–∞—Ç–æ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è 